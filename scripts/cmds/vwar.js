const axios = require('axios');
const fs = require('fs-extra');

module.exports = {
  config: {
    name: "vwar",
    version: "3.2",
    author: "Redwan",
    countDown: 5,
    role: 0,
    category: "Fun",
    ShortDescription: "Voice war with mentions",
    LongDescription: "Tag a user and the bot will send multiple TTS voice messages to scold them.",
    guide: {
      en: "{pn} @mention"
    }
  },

  onStart: async function ({ api, event, args }) {
    const mention = Object.keys(event.mentions)[0];
    if (!mention) return api.sendMessage("Tag one person to start the voice war!", event.threadID);

    const name = event.mentions[mention];
    const arraytag = [{ id: mention, tag: name }];
    const delay = 3000;

    const messages = [
      `à¦¤à¦° à¦®à¦¾à¦° à¦­à§‹à¦¦à¦¾à§Ÿ à¦ªà¦¾à¦¬à§à¦²à¦¿à¦• à¦Ÿà§Ÿà¦²à§‡à¦Ÿ ğŸ¥µà¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦° à¦­à§à¦¦à¦¾à¦¤à§‡ à¦ªà§‹à¦•à¦¾ ğŸ¥µà¦¤à¦° à¦¬à¦¾à¦ªà§‡à¦° à¦¹à§‹à¦² à¦¤à¦° à¦¬à¦‰à§Ÿà§‡à¦° à¦­à§‹à¦¦à¦¾à¦¤à§‡à¦¦à¦¿à¦®à§ ${name}`,
      `à¦†à¦¬à¦¾à¦² à¦šà§‹à¦¦à¦¾ à¦•à¦¾à¦¨à§à¦¦à§‡ à¦«à¦¾à¦²à¦¾à¦‡à§Ÿà¦¾ à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦°à§‡ à¦šà§à¦¦à¦¿ğŸ¥µğŸ¥µ ${name}`,
      `à¦­à§à¦¦à¦¾à¦° à¦¬à§‡à¦Ÿà¦¾ à¦¤à¦° à¦®à¦¾ à¦à¦° à¦­à§à¦¦à¦¾à§Ÿ à¦§à¦¾à¦¨ à¦›à§œà¦¾à¦‡à§Ÿà¦¾ à¦šà§œà§à¦‡ à¦¦à¦¿à§Ÿà¦¾ à¦–à¦¾à¦“à§Ÿà¦¾à¦®à§â¤ ${name}`,
      `à¦¹à§‹à¦—à¦¾à¦° à¦­à¦¿à¦¤à¦°à§‡ à¦­à¦‡à§œà¦¾ à¦¦à¦¿à¦®à§â€¦à¦ à§à¦¯à¦¾à¦à¦™ à¦•à¦¾à¦‡à¦Ÿà§à¦Ÿà¦¾ à¦ªà§à¦Ÿà¦•à¦¿ à¦¦à¦¾ à¦­à¦‡à¦°à¦¾ à¦¦à§à¦®! à¦¹à¦¾à¦²à¦¾ à¦²à§à¦¯à¦¾à¦“à§œà¦¾ à¦šà§‹à¦¦à¦¾ ${name}`,
      `à¦¶à§à§Ÿà§‹à¦°à§‡à¦° à¦¬à¦¾à¦šà§à¦šà¦¾ à¦•à§à¦¤à§à¦¤à¦¾à¦° à¦¬à¦¾à¦šà§à¦›à¦¾ à¦¹à¦¾à¦°à¦¾à¦®à¦¿à¦° à¦¬à¦¾à¦šà§à¦šà¦¾ à¦¹à¦¾à¦°à¦¾à¦®à¦¿ à¦¹à¦¾à¦°à¦¾à¦®à¦œà¦¾à¦¦à¦¾ à¦¹à¦¾à¦°à¦¾à¦®à¦–à§‹à¦° à¦–à¦¾à¦¨à§à¦•à¦¿ à¦®à¦¾à¦—à¦¿à¦° à¦ªà§‹à¦²à¦¾ğŸ˜­ ${name}`,
      `à¦•à¦¾à¦¨à§à¦¦à§‡ à¦«à¦¾à¦²à¦¾à¦‡à§Ÿà¦¾ à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦°à§‡ à¦šà§à¦¦à¦¿ğŸ¤ â¤ ${name}`,
      `à¦§à§‹à¦¨ à¦•à¦¾à¦‡à¦Ÿà§à¦Ÿà¦¾ à¦•à§à¦¤à§à¦¤à¦¾ à¦¦à¦¿à§Ÿà¦¾ à¦–à¦¾à¦“à§Ÿà¦¾à¦®à§ ${name}`,
      `à¦¤à§‹à¦—à§‹à¦°à§‡ à¦«à¦¾à¦¸à¦¿à¦¤à§‡ à¦²à¦Ÿà¦•à¦¾à¦‡à§Ÿà¦¾ à¦šà§à¦¦à¦®à§ ${name}`,
      `à¦¤à§‹à¦—à§‹à¦° à¦§à§‹à¦¨ à¦Ÿà¦¾à¦‡à¦¨à¦¾ à¦¤à§‹à¦—à§‹à¦° à¦ªà¦¿à¦›à¦¨ à¦¦à¦¿à§Ÿà¦¾ à¦¢à§à¦•à¦¾à¦®à§ğŸ’‹ ${name}`,
      `à¦œà¦‚ à¦§à¦°à¦¾ à¦²à§‹à¦¹à¦¾ à¦¦à¦¿à§Ÿà¦¾ à¦ªà¦¾à¦•à¦¿à¦¸à§à¦¤à¦¾à¦¨à§‡à¦° à¦®à¦¾à¦¨à¦šà¦¿à¦¤à§à¦° à¦¬à¦¾à¦¨à¦¾à¦‡à§à§Ÿà¦¾ à¦¤à§‹à¦¦à§‡à¦° à¦ªà¦¿à¦›à¦¨ à¦¦à¦¿à§Ÿà¦¾ à¦¢à§à¦•à¦¾à¦®à§ ${name}`,
      `à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦° à¦­à§‹à¦¦à¦¾ à¦¶à¦¿à¦°à¦¿à¦· à¦•à¦¾à¦—à¦œ à¦¦à¦¿à§Ÿà¦¾ à¦˜à¦‡à¦·à¦¾ à¦¦à¦¿à¦®à§à¥¤ğŸ˜­ğŸ’‹ ${name}`,
      `à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦° à¦­à§‹à¦¦à¦¾ à¦¬à§‹à¦®à§à¦¬à¦¾à¦‡ à¦®à¦°à¦¿à¦š à¦¦à¦¿à§Ÿà¦¾ à¦šà§à¦¦à¦¾à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦¬à¦¾à¦ªà§‡à¦° à¦ªà§à¦Ÿà¦•à¦¿à¦° à¦«à§à¦Ÿà¦¾ à¦¦à¦¿à§Ÿà¦¾ à¦•à¦¾à¦¡à¦² à¦¢à§à¦•à¦¾à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦¬à§Œà§Ÿà§‡à¦° à¦­à§‹à¦¦à¦¾à§Ÿ à¦®à¦¾à¦—à§à¦° à¦®à¦¾à¦› à¦šà¦¾à¦· à¦•à¦°à§à¦®à¥¤ ${name}`,
      `à¦¹à¦¾à¦¤à¦¿à¦° à¦²à§à¦¯à¦¾à¦“à§œà¦¾ à¦¦à¦¿à§Ÿà¦¾ à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦°à§‡ à¦šà§à¦¦à§à¦®à¥¤ğŸ¤ â¤ ${name}`,
      `à¦¤à¦° à¦®à¦¾à§Ÿà§‡à¦° à¦­à§‹à¦¦à¦¾ à¦›à¦¿à¦²à§à¦²à¦¾ à¦²à¦¬à¦£ à¦²à¦¾à¦—à¦¾à§Ÿ à¦¦à¦¿à¦®à§à¥¤ ${name}`,
      `à¦¤à§‹à¦° à¦®à¦¾ à¦¬à§‹à¦¨ à¦¬à¦‰ à¦°à§‡ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦à¦•à¦Ÿà¦¾ à¦•à¦¨à¦¡à¦® à¦¦à¦¿à§Ÿà§‡ à¦šà§à¦¦à¦¿ğŸ¤ â¤ ${name}`,
      `à¦–à¦¾à¦‚à¦•à¦¿à¦° à¦ªà§‹à¦²à¦¾ à¦¤à§‹à¦° à¦®à¦¾ à¦°à§‡ à¦—à¦¾à¦› à¦à¦° à¦¸à¦¾à¦¥à§‡ à¦¬à§‡à¦§à§‡ à¦­à§à¦¦à¦¾à¦° à¦®à¦§à§à¦¯à§‡ à¦¤à¦¾à¦²à¦—à¦¾à¦› à¦¢à§à¦•à¦¿à§Ÿà§‡ à¦šà§à¦¦à¦¿ğŸ¥µ ${name}`,
      `à¦¬à§‡à¦¸à§à¦¯à¦¾ à¦•à¦¨à¦¡à¦® à¦«à¦¾à¦Ÿà¦¾ à¦­à§à¦¦à¦¾ à¦›à¦¿à§œà¦¾ à¦¤à§‹à¦° à¦®à¦¾ à¦°à§‡ à¦¸à§‹à¦«à¦¾à§Ÿ à¦«à¦¾à¦²à¦¾à§Ÿà¦¾ à¦šà§à¦¦à¦¿ğŸ¤ ğŸ«€ ${name}`,
      `à¦¤à¦° à¦®à¦¾à¦•à§‡ à¦†à¦²à¦®à¦¾à¦°à¦¿à¦° à¦¸à¦¾à¦¥à§‡ à¦¬à§‡à¦à¦§à§‡ à¦šà§à¦¦à¦¿ à¦¯à¦¾à¦¤à§‡ à¦†à¦°à¦¾à¦®à§‡ à¦šà§à¦¦à¦¾ à¦¯à¦¾à§Ÿ ${name}`,
      `à¦¬à¦¿à¦¦à§à§ à¦à¦° à¦•à¦¾à¦°à§‡à¦¨à§à¦Ÿ à¦¤à¦° à¦®à¦¾ à¦° à¦­à§à¦¦à¦¾à§Ÿ à¦ªà§à¦°à¦¬à§‡à¦¶ à¦•à¦°à¦¿à§Ÿà§‡ à¦‡à¦²à§‡à¦•à¦Ÿà§à¦°à¦¨à¦¿à¦• à¦¸à¦°à§à¦Ÿ à¦¦à¦¿à§Ÿà§‡ à¦¤à¦° à¦®à¦¾à¦•à§‡ à¦šà§à¦¦à¦¿ğŸ™€â¤ ${name}`,
      `à¦¤à§‹à¦° à¦®à¦¾ à¦°à§‡ à¦®à¦¾à¦¸à¦¿à¦• à¦†à¦Ÿà¦•à¦¾à¦‡à§Ÿà¦¾ à¦®à§‡à¦°à§‡ à¦«à§‡à¦²à¦¬à§‹ğŸ˜˜ ${name}`,
      `à¦¤à¦° à¦®à¦¾à¦°à§‡ à¦ªà¦¦à§à¦®à¦¾ à¦¸à§‡à¦¤à§à¦° à§­à¦¨à¦¾à¦®à§à¦¬à¦¾à¦° à¦ªà¦¿à¦²à¦¾à¦°à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¹à¦¾à¦¤ à¦ªà¦¾ à¦¬à§‡à¦¦à§‡ à¦•à¦¾à¦²à¦¾ à¦•à§à¦¤à§à¦¤à¦¾ à¦¦à¦¿à§Ÿà§‡ à¦šà§à¦¦à¦¾à¦‡ğŸ¤ â¤ ${name}`,
      `à¦‰à¦®à§à¦®à¦®à§à¦®à¦¾ à¦¤à¦° à¦¬à§‹à¦¨ à¦à¦°à¦•à¦šà¦¿ à¦­à§à¦¦à¦¾à§ŸğŸ’‰ ${name}`,
      `DNA à¦Ÿà§‡à¦·à§à¦Ÿ à¦•à¦°à¦¾ à¦¦à§‡à¦–à¦¬à¦¿ à¦†à¦®à¦¾à¦° à¦šà§à¦¦à¦¾ à¦¤à§‡à¦‡ à¦¤à¦° à¦œà¦¨à§à¦®à¥¤ ${name}`,
      `à¦¬à¦¾à¦¨à§à¦¦à¦¿à¦° à¦ªà§‹à¦²à¦¾ à¦¤à¦° à¦•à¦šà¦¿ à¦¬à§‹à¦¨à§‡à¦° à¦­à§à¦¦à¦¾ à¦«à¦¾à¦• à¦•à¦° à¦¥à§à¦¤à§ à¦¦à¦¿à§Ÿà§‡ à¦­à§à¦¦à¦¾à§Ÿ à¦¦à¦¨ à¦¡à§à¦•à¦¾à¦®à§ ğŸ¤Ÿ ${name}`,
      `à¦‰à¦«à¦«à¦« à¦–à¦¾à¦¦à§à¦¦à¦¾à¦®à¦¾ à¦®à¦¾à¦—à¦¿à¦° à¦ªà§‹à¦²à¦¾ à¦¤à¦° à¦†à¦®à§à¦®à§à¦° à¦•à¦¾à¦²à¦¾ à¦­à§à¦¦à¦¾à§Ÿ à¦†à¦®à¦¾à¦° à¦®à¦¾à¦² à¦†à¦‰à¦Ÿ à¦¤à¦° à¦•à¦šà¦¿ à¦¬à§‹à¦¨ à¦°à§‡ à¦‰à¦ªà§à¦¤à¦¾ à¦•à¦°à§‡ à¦à¦¬à¦¾à¦° à¦šà§à¦¦à¦¬à§‹ ğŸ’‰ ${name}`,
      `à¦¤à¦° à¦®à§à¦–à§‡ à¦¹à¦¾à¦‡à¦—à§à¦¯à¦¾ à¦¦à¦¿à¦®à§à¥¤ à¦­à§à¦¸à§à¦•à¦¿ à¦®à¦¾à¦—à¦¿à¦° à¦ªà§‹à¦²à¦¾ ğŸ¤£ ${name}`,
      `à¦¹à¦¿à¦œà¦²à¦¾ à¦®à¦¾à¦—à¦¿à¦° à¦ªà§‹à¦²à¦¾ à¦¬à¦¾à¦²à¦¿ à¦¦à¦¿à§Ÿà¦¾ à¦šà§à¦¦à¦®à§ à¦¤à¦°à§‡ à¦–à¦¾à¦™à§à¦•à¦¿ à¦®à¦¾à¦—à§€!à¦¤à¦° à¦®à¦¾à¦•à§‡ ${name}`,
      `à¦Ÿà§à¦•à¦¾à¦‡ à¦®à¦¾à¦—à¦¿à¦° à¦ªà§‹à¦²à¦¾ à¦®à§‹à¦¬à¦¾à¦‡à¦² à¦­à¦¾à¦‡à¦¬à§à¦°à§‡à¦¶à¦¨ à¦•à¦‡à¦°à¦¾ à¦¤à§à¦° à¦•à¦šà¦¿ à¦¬à§‹à¦¨ à¦à¦° à¦ªà§à¦•à¦Ÿà¦¿à¦¤à§‡ à¦­à¦°à¦¬à§‹à¥¤ğŸ¤Ÿ ${name}`,
      `à¦¤à¦° à¦†à¦®à§à¦®à§à¦° à¦ªà¦¾à¦›à¦¾à§Ÿ à¦¬à¦°à¦« à¦²à¦¾à¦—à¦¾à§Ÿ à¦¦à¦¿à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦­à¦¾à¦‡à¦°à§‡ à¦¡à§‹à¦¬à¦¾à§Ÿ à¦šà§à¦¬à¦¾à¦‡à§Ÿà¦¾ à¦®à¦¾à¦°à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦—à¦¾à¦°à§à¦²à¦«à§à¦°à§‡à¦¨à§à¦¡à§‡à¦° à¦ªà¦¾à¦›à¦¾à§Ÿ à¦†à¦—à§à¦¨ à¦¦à¦¿à§Ÿà¦¾ à¦ªà§à§œà¦¾à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦¬à¦¾à¦ªà¦°à§‡ à¦Ÿà§à¦¯à¦¾à¦‚à¦• à¦¦à¦¿à§Ÿà¦¾ à¦šà¦¾à¦ªà¦¾ à¦¦à¦¿à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦«à§à¦¯à¦¾à¦®à¦¿à¦²à¦¿ à¦ªà¦¿à¦•à¦¨à¦¿à¦•à§‡ à¦¨à¦¿à§Ÿà¦¾ à¦—à¦¿à§Ÿà§‡ à¦•à§à¦¤à§à¦¤à¦¾ à¦¦à¦¿à§Ÿà¦¾ à¦šà§à¦¦à¦¾à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦¬à¦¾à§œà¦¿à¦° à¦¦à¦°à¦œà¦¾à§Ÿ à¦¹à¦¾à¦¤à¦¿ à¦¦à¦¿à§Ÿà¦¾ à¦§à¦¾à¦•à§à¦•à¦¾ à¦®à¦¾à¦°à¦®à§à¥¤ ${name}`,
      `à¦¤à¦° à¦®à¦¾à¦•à§‡ à¦«à§à¦Ÿà¦¬à¦² à¦¬à¦¾à¦¨à¦¿à§Ÿà§‡ à¦–à§‡à¦²à¦®à§à¥¤ ${name}`
    ];

    async function processMessages(index) {
      if (index >= messages.length) return;

      const text = messages[index].trim();
      const path = `./tts_${index}.mp3`;
      const apiURL = `https://tts-siam-apiproject.vercel.app/speech?text=${encodeURIComponent(text)}`;

      try {
        const response = await axios({
          method: "get",
          url: apiURL,
          responseType: "stream"
        });

        const writer = fs.createWriteStream(path);
        response.data.pipe(writer);

        writer.on("finish", async () => {
          await api.sendMessage(
            { body: text, attachment: fs.createReadStream(path), mentions: arraytag },
            event.threadID,
            async () => {
              fs.remove(path);
              setTimeout(() => processMessages(index + 1), delay);
            }
          );
        });

      } catch (err) {
        console.error(err);
        api.sendMessage(`Error processing message ${index + 1}: "${text}"`, event.threadID);
        setTimeout(() => processMessages(index + 1), delay);
      }
    }

    processMessages(0);
  }
};
